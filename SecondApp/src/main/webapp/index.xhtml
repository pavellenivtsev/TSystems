<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
    <title>Logistic state</title>
    <h:outputStylesheet library="css" name="main.css"/>
    <h:outputStylesheet library="css" name="bootstrap.css"/>
</h:head>
<h:body>
    <div class="container" id="main-container">
        <p:dataTable value="#{memoryBean.getUserOrderDtoList()}" var="userOrder"
                     rendered="#{memoryBean.userOrderDtoList !=null}" class="table table-striped" id="orderTable">
            <f:facet name="header">Orders</f:facet>

            <p:columnGroup type="header">
                <p:row>
                    <p:column colspan="2" headerText="Order"/>
                    <p:column colspan="5" headerText="Cargo"/>
                </p:row>
                <p:row>
                    <p:column headerText="Unique number"/>
                    <p:column headerText="Status"/>
                    <p:column headerText="Name"/>
                    <p:column headerText="Weight"/>
                    <p:column headerText="Status"/>
                    <p:column headerText="Place of departure"/>
                    <p:column headerText="Delivery place"/>
                </p:row>
            </p:columnGroup>

                <p:column rowspan="#{userOrder.cargoList.size()}" groupRow="true">
                    <h:outputText value="#{userOrder.uniqueNumber}"/>
                </p:column>
                <p:column rowspan="#{userOrder.cargoList.size()}" groupRow="true">
                    <h:outputText value="#{userOrder.status.name().replaceAll('_','').toLowerCase()}"/>
                </p:column>

            <!--            <p:column rowspan="#{userOrder.cargoList.size()}">-->
            <!--                <h:outputText value="#{userOrder.uniqueNumber}"/>-->
            <!--            </p:column>-->
            <!--            <p:column rowspan="#{userOrder.cargoList.size()}">-->
            <!--                <h:outputText value="#{userOrder.status.name().replaceAll('_','').toLowerCase()}"/>-->
            <!--            </p:column>-->
            <!--            <p:column>-->
            <!--                <h:outputText value="#{userOrder.cargoList.get(0).name}"/>-->
            <!--            </p:column>-->
            <!--            <p:column>-->
            <!--                <h:outputText value="#{userOrder.cargoList.get(0).weight}"/>-->
            <!--            </p:column>-->
            <!--            <p:column>-->
            <!--                <h:outputText value="#{userOrder.cargoList.get(0).status}"/>-->
            <!--            </p:column>-->
            <!--            <p:column>-->
            <!--                <h:outputText value="#{userOrder.cargoList.get(0).loadingAddress}"/>-->
            <!--            </p:column>-->
            <!--            <p:column>-->
            <!--                <h:outputText value="#{userOrder.cargoList.get(0).unloadingAddress}"/>-->
            <!--            </p:column>-->


            <!--                <ui:repeat value="#{userOrder.cargoList}" var="cargo" begin="1">-->
            <!--                    <p:row>-->
            <!--                        <p:column>-->
            <!--                            <h:outputText value="#{cargo.name}"/>-->
            <!--                        </p:column>-->
            <!--                        <p:column>-->
            <!--                            <h:outputText value="#{cargo.weight}"/>-->
            <!--                        </p:column>-->
            <!--                        <p:column>-->
            <!--                            <h:outputText value="#{cargo.status}"/>-->
            <!--                        </p:column>-->
            <!--                        <p:column>-->
            <!--                            <h:outputText value="#{cargo.loadingAddress}"/>-->
            <!--                        </p:column>-->
            <!--                        <p:column>-->
            <!--                            <h:outputText value="#{cargo.unloadingAddress}"/>-->
            <!--                        </p:column>-->
            <!--                    </p:row>-->
            <!--                </ui:repeat>-->
            <!--            <p:column rowspan="#{userOrder.cargoList.size()}">-->
            <!--                <h:outputText value="#{userOrder.uniqueNumber}"/>-->
            <!--            </p:column>-->
            <!--            <p:column rowspan="#{userOrder.cargoList.size()}">-->
            <!--                <h:outputText value="#{userOrder.status.name().replaceAll('_','').toLowerCase()}"/>-->
            <!--            </p:column>-->
        </p:dataTable>


        <p:dataTable value="#{memoryBean.getCountTable()}" var="entry"
                     rendered="#{memoryBean.countTable !=null}" class="table table-striped" id="countTable">
            <f:facet name="header">Statistics</f:facet>
            <p:column headerText="Name">
                <h:column>#{entry.name}</h:column>
            </p:column>

            <p:column headerText="Quantity">
                <h:column>#{entry.value}</h:column>
            </p:column>
        </p:dataTable>

        <h:form>
            <f:websocket channel="someChannel">
                <f:ajax event="updateOrders" render=":orderTable"/>
                <f:ajax event="updateCountTable" render=":countTable"/>
            </f:websocket>
        </h:form>
    </div>
</h:body>
</html>